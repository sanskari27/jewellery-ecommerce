generator client {
  provider   = "prisma-client-js"
  engineType = "library"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

//-----------------------------------------Account---------------------------------

// ----------------------------------------- Cart-------------------------------

model Session {
  id   String     @id @default(uuid())
  cart CartItem[]
}

model CartItem {
  quantity        Int           @default(1)
  product_option  ProductOption @relation(fields: [productOptionId], references: [id])
  productOptionId String

  product   Product @relation(fields: [productId], references: [id])
  productId String

  session   Session @relation(fields: [sessionId], references: [id])
  sessionId String

  @@id([sessionId, productOptionId])
}

// ----------------------------------------- Product-------------------------------

model Product {
  id           String @id @default(uuid())
  product_code String @unique

  name        String
  description String

  baseOptionIndex Int
  options         ProductOption[]
  CartItem        CartItem[]
}

model ProductOption {
  id           String @id @default(uuid())
  product_code String @unique

  name        String
  price       Float
  description String

  width  Float
  height Float
  weight Float

  metal_type   MetalType
  metal_purity String
  metal_weight Float

  dimond_type   DimondType
  dimond_weight Float
  dimond_count  Int

  others Json
  tags   String[]

  Product   Product    @relation(fields: [productId], references: [id])
  productId String
  CartItem  CartItem[]
}

model Account {
  phone String  @id
  email String
  name  String?
}

enum MetalType {
  WHITE_GOLD
  YELLOW_GOLD
}

enum DimondType {
  NONE
  WHITE
  YELLOW
}
