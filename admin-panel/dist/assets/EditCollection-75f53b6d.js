import{u as U,a as M,k as V,r as h,b as y,S as F,e as k,N as W,j as e,s as _,c as K,F as $,I as G,l as H,m as X,f as d,C as x,n as q,h as J,i as Q,d as E}from"./index-c8a2b0d9.js";import{T as Y,P as Z,M as ee,D as re}from"./index-59c59c7a.js";import{F as se}from"./file.service-96c3315b.js";import{E as oe}from"./Each-bea6588f.js";import{T as te,a as ae,b as le,c as z,d as u,e as ie,f as g}from"./chunk-MGVPL3OH-a6133c63.js";import{C as ne}from"./chunk-CWVAJCXJ-c2df9ed2.js";import{M as ce,a as de,b as me,c as pe,d as he,e as xe}from"./chunk-4FCEGNGT-7162d099.js";import{B as f}from"./chunk-PULVB27S-5c8c41c1.js";import{F as B}from"./chunk-56K2BSAJ-c484cfc7.js";import{F as I}from"./chunk-H46NUPBZ-dd69c2b8.js";import{I as ue}from"./chunk-6CVSDS6C-2aa348d8.js";import{T as l}from"./chunk-2OOHT3W5-e661ad39.js";import{V as ge}from"./chunk-NTCQBYKE-2ca16325.js";import{B as fe}from"./chunk-UVUR7MCU-52014813.js";import"./chunk-7D6N5TE5-e13f872c.js";import"./index-2842c37b.js";import"./chunk-ZHMYA64R-dc276fff.js";function Re(){const i=U(),s=M(),{id:t}=V(),a=h.useRef(null),{editSelected:{name:m,productCodes:p},fileDetails:{file:n,size:w,url:N},uiDetails:{error:c,isSaving:A},tagsString:j}=y(r=>r[F.COLLECTIONS]),{list:D}=y(r=>r[F.PRODUCTS]),C=h.useCallback(()=>{s(k("new")),i(W.COLLECTIONS)},[s,i]);h.useEffect(()=>{s(k(t??"new"))},[t,s]);const R=r=>{var o;(o=a.current)==null||o.setProgressValue(r)},P=async()=>{if(s(d(!0)),!t)return s(d(!1)),alert("Unable to edit collection. Please refresh and retry.");if(n&&!await se.uploadFile("collections",n,R))return s(d(!1)),alert("Error uploading file...");const r=j.split(",").map(o=>o.trim()).filter(o=>!!o).map(o=>o.charAt(0).toUpperCase()+o.substring(1).toLowerCase());await x.updateCollectionTags(t,r),await x.updateProductsInCollection(t,p),x.getCollection().then(o=>s(q(o))),s(d(!1)),C()},L=r=>{if(r===null)return;const o=window.URL.createObjectURL(r),S=r.size/1024,T=S/1024;let v="";r.type.includes("image")&&(v="image"),s(J({file:r,type:v,size:T>1?`${T.toFixed(2)} MB`:`${S.toFixed(2)} KB`,url:o}))},O=()=>{s(Q())};return e.jsxs(ce,{isCentered:!0,isOpen:!0,onClose:C,size:"4xl",children:[e.jsx(de,{bg:"blackAlpha.600",backdropFilter:"blur(5px)"}),e.jsxs(me,{children:[e.jsx(pe,{}),e.jsx(he,{}),e.jsx(xe,{children:e.jsxs(f,{children:[e.jsxs(B,{isInvalid:c==="NAME",children:[e.jsx(I,{children:"Collection name"}),e.jsx(ue,{placeholder:"eg. Rings",value:m??"",onChange:r=>s(_(r.target.value)),borderColor:c==="NAME"?"red.500":"black",borderWidth:"1px",padding:"0.5rem",marginTop:"-0.25rem",variant:"unstyled",_placeholder:{color:c?"red.500":"black",opacity:.7},isDisabled:!!t})]}),e.jsxs(B,{mt:"1rem",children:[e.jsx(I,{children:"Tags"}),e.jsx(Y,{placeholder:"Enter tags separated by commas.",value:j??"",onChange:r=>s(K(r.target.value)),borderColor:"black",borderWidth:"1px",padding:"0.5rem",marginTop:"-0.25rem",variant:"unstyled",_placeholder:{color:"black",opacity:.7}})]}),e.jsx(f,{mt:"1rem",children:n?e.jsxs(ge,{alignItems:"stretch",gap:"0.5rem",children:[e.jsxs(l,{children:["Selected file : ",n.name]}),e.jsxs($,{alignItems:"center",justifyContent:"space-between",children:[e.jsxs(l,{children:["Selected file size : ",w]}),e.jsx(l,{textColor:"red.400",fontWeight:"normal",cursor:"pointer",onClick:O,children:"Remove"})]}),e.jsx(G,{src:N,aspectRatio:"16/9",borderRadius:"lg"})]}):e.jsxs(e.Fragment,{children:[e.jsx(je,{onFileInput:L,isInvalid:c==="FILE"}),e.jsx(l,{textAlign:"center",fontSize:"xs",children:"*File size should be less than 2MB"})]})}),e.jsx(te,{pt:"0.5rem",textColor:"black",children:e.jsxs(ae,{children:[e.jsx(le,{children:e.jsxs(z,{children:[e.jsx(u,{color:"gray",width:"5%",children:"Sl no"}),e.jsx(u,{color:"gray",width:"75%",children:"Name"}),e.jsx(u,{color:"gray",width:"20%",isNumeric:!0,children:"Price"})]})}),e.jsx(ie,{children:e.jsx(oe,{items:D,render:(r,o)=>e.jsxs(z,{verticalAlign:"middle",cursor:"pointer",children:[e.jsxs(g,{children:[e.jsx(ne,{mr:"1rem",isChecked:p.includes(r.productCode),onChange:b=>{b.target.checked?s(H(r.productCode)):s(X(r.productCode))},colorScheme:"green"}),o+1,"."]}),e.jsx(g,{children:r.name}),e.jsx(g,{isNumeric:!0,children:r.price})]})})})]})}),e.jsx(Z,{ref:a})]})}),e.jsx(ee,{justifyContent:"center",children:e.jsx(fe,{isLoading:A,isDisabled:p.length===0,onClick:P,paddingX:"40px",bgColor:"blue.400",_hover:{bgColor:"blue.500"},color:"white",children:"SAVE"})})]})]})}function je({onFileInput:i,isInvalid:s}){const t=M();return e.jsx(re,{onDropAccepted:a=>{i(a[0])},maxSize:2097152,onDropRejected:()=>t(E("File size should be less than 2MB")),multiple:!1,onError:a=>{t(E(a.message))},children:({getRootProps:a,getInputProps:m})=>e.jsxs(f,{...a(),borderWidth:"1px",borderColor:s?"red.500":"black",borderStyle:"dashed",borderRadius:"lg",py:"3rem",textAlign:"center",textColor:s?"red.300":"black",children:[e.jsx("input",{...m()}),e.jsx(l,{children:"Drag and drop file here, or click to select files"})]})})}export{Re as default};
