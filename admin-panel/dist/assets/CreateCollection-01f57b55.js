import{u as k,a as F,r as p,b as R,S as T,e as f,N as A,j as e,s as N,c as D,F as L,I as w,d as n,f as j,C as b,g as O,h as V,i as P}from"./index-c8a2b0d9.js";import{T as W,P as U,M as _,D as K}from"./index-59c59c7a.js";import{F as $}from"./file.service-96c3315b.js";import{M as G,a as H,b as X,c as q,d as J,e as Q}from"./chunk-4FCEGNGT-7162d099.js";import{F as C}from"./chunk-56K2BSAJ-c484cfc7.js";import{F as S}from"./chunk-H46NUPBZ-dd69c2b8.js";import{I as Y}from"./chunk-6CVSDS6C-2aa348d8.js";import{V as Z}from"./chunk-NTCQBYKE-2ca16325.js";import{T as i}from"./chunk-2OOHT3W5-e661ad39.js";import{B as m}from"./chunk-PULVB27S-5c8c41c1.js";import{B as ee}from"./chunk-UVUR7MCU-52014813.js";import"./index-2842c37b.js";import"./chunk-ZHMYA64R-dc276fff.js";function ge(){const c=k(),r=F(),l=p.useRef(null),{editSelected:{name:s},fileDetails:{file:a,size:v,url:y},uiDetails:{error:d},tagsString:E}=R(t=>t[T.COLLECTIONS]),u=p.useCallback(()=>{r(f("new")),c(A.COLLECTIONS)},[r,c]);p.useEffect(()=>{r(f("new"))},[r]);const I=t=>{var o;(o=l.current)==null||o.setProgressValue(t)},z=async()=>{if(!a)return r(n("FILE"));r(j(!0));const t=await $.uploadFile("collections",a,I);if(!t)return r(n("Error uploading file..."));const o=await b.createCollection(b.getCollectionId(s),s,t);if(!o)return r(n("Error creating collection..."));r(O(o)),u(),r(j(!1))},B=t=>{if(t===null)return;const o=window.URL.createObjectURL(t),x=t.size/1024,h=x/1024;let g="";t.type.includes("image")&&(g="image"),r(V({file:t,type:g,size:h>1?`${h.toFixed(2)} MB`:`${x.toFixed(2)} KB`,url:o}))},M=()=>{r(P())};return e.jsxs(G,{isCentered:!0,isOpen:!0,onClose:u,size:"2xl",children:[e.jsx(H,{bg:"blackAlpha.600",backdropFilter:"blur(5px)"}),e.jsxs(X,{children:[e.jsx(q,{}),e.jsx(J,{}),e.jsx(Q,{children:e.jsxs(m,{children:[e.jsxs(C,{isInvalid:d==="NAME",children:[e.jsx(S,{children:"Collection name"}),e.jsx(Y,{placeholder:"eg. Rings",value:s??"",onChange:t=>r(N(t.target.value)),borderColor:d==="NAME"?"red.500":"black",borderWidth:"1px",padding:"0.5rem",marginTop:"-0.25rem",variant:"unstyled",_placeholder:{color:d?"red.500":"black",opacity:.7}})]}),e.jsxs(C,{mt:"1rem",children:[e.jsx(S,{children:"Tags"}),e.jsx(W,{placeholder:"Enter tags separated by commas.",value:E??"",onChange:t=>r(D(t.target.value)),borderColor:"black",borderWidth:"1px",padding:"0.5rem",marginTop:"-0.25rem",variant:"unstyled",_placeholder:{color:"black",opacity:.7}})]}),e.jsx(m,{mt:"1rem",children:a?e.jsxs(Z,{alignItems:"stretch",gap:"0.5rem",children:[e.jsxs(i,{children:["Selected file : ",a.name]}),e.jsxs(L,{alignItems:"center",justifyContent:"space-between",children:[e.jsxs(i,{children:["Selected file size : ",v]}),e.jsx(i,{textColor:"red.400",fontWeight:"normal",cursor:"pointer",onClick:M,children:"Remove"})]}),e.jsx(w,{src:y,aspectRatio:"16/9",borderRadius:"lg"})]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{onFileInput:B,isInvalid:d==="FILE"}),e.jsx(i,{textAlign:"center",fontSize:"xs",children:"*File size should be less than 2MB"})]})}),e.jsx(U,{ref:l})]})}),e.jsx(_,{justifyContent:"center",children:e.jsx(ee,{onClick:z,paddingX:"40px",bgColor:"blue.400",_hover:{bgColor:"blue.500"},color:"white",children:"SAVE"})})]})]})}function re({onFileInput:c,isInvalid:r}){const l=F();return e.jsx(K,{onDropAccepted:s=>{c(s[0])},maxSize:2097152,onDropRejected:()=>l(n("File size should be less than 2MB")),multiple:!1,onError:s=>{l(n(s.message))},children:({getRootProps:s,getInputProps:a})=>e.jsxs(m,{...s(),borderWidth:"1px",borderColor:r?"red.500":"black",borderStyle:"dashed",borderRadius:"lg",py:"3rem",textAlign:"center",textColor:r?"red.300":"black",children:[e.jsx("input",{...a()}),e.jsx(i,{children:"Drag and drop file here, or click to select files"})]})})}export{ge as default};
